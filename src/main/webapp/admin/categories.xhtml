<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3c.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/main.xhtml">
    <ui:define name="content">

        <h:form enctype="multipart/form-data" style="width: 50%; margin-top: 10px; float: right;">
            <p:fileUpload value="#{topicParserController.file}" mode="simple" skinSimple="true" style="color: white"/>
            <p:commandButton value="Submit" ajax="false" action="#{topicParserController.upload}"
                             styleClass="p-mt-3 ui-button-outlined p-d-block"/>
        </h:form>
        <h:form id="topicForm">
            <p:growl id="topicData" showDetail="false" life="6000">
                <p:autoUpdate/>
            </p:growl>

            <p:commandButton style="width: 10%; margin-top: 9px;margin-right: 9px; float: right;" id="help"
                             oncomplete="PF('helpDialog').show()" icon="ui-icon-info" value="Help" title="Help"/>
            <p:dialog header="Info" id="helpDialog" widgetVar="helpDialog" width="400">
                <h:panelGrid columns="1">
                    <h2 style="color: #0d9dbb; font-weight: bold; margin-top: 2px">Choose File</h2>
                    <h:outputText value="Click to the 'choose' button to add a json File and submit. The json File should contain 1 Topic and associated Terms. Here the
json File could contain several Terms. "/>
                    <h2 style="color: #0d9dbb; font-weight: bold;">Create new Topic</h2>
                    <h:outputText value="Click to the button to add a new Topic."/>
                    <h2 style="color: #0d9dbb; font-weight: bold;">Add Term</h2>
                    <h:outputText value="Click to the button to add a new Term."/>
                    <h2 style="color: #0d9dbb; font-weight: bold;">Delete Topic</h2>
                    <h:outputText value="Click to the button to delete the Topic."/>
                </h:panelGrid>
            </p:dialog>

            <p:dataTable widgetVar="topicCreationTable" id="topicCreationTable" var="topic"
                         value="#{topicListController.topicAmount}" style="width: 83%; margin-top: 85px; float: right;">
                <f:facet name="header">Topic Hub</f:facet>
                <p:column headerText="Themengebiet">
                    <h:outputText value="#{topic.topic.topicName}"/>
                </p:column>
                <p:column headerText="Anzahl Begriffe">
                    <h:outputText value="#{topic.gameCount}"/>
                </p:column>

                <p:column style="width:100px;text-align: center" headerText="create term">
                    <p:commandButton title="Terms" icon="ui-icon-note"
                                     action="#{termListController.doSetTopic(topicController.gameTopicCount.topic)}"
                                     update=":termsForm" oncomplete="$('#topicForm').hide();$('#termsForm').show();"
                                     style="width:20px;height:20px">
                        <f:setPropertyActionListener value="#{topic}" target="#{topicController.gameTopicCount}"/>
                    </p:commandButton>

                    <p:commandButton action="#{topicController.doDeleteTopic}" icon="ui-icon-trash" title="Delete"
                                     update=":topicForm:topicCreationTable">
                        <f:setPropertyActionListener value="#{topic}" target="#{topicListController.topics}"/>
                        <p:confirm header="Confirmation"
                                   message="Are you sure that you want to delete this topic? You cannot undo this operation."
                                   icon="ui-icon-alert"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>
            <p:commandButton style="width: 25%; margin-top: 25px; float: right;"
                             oncomplete="PF('topicCreationDialog').show()" icon="ui-icon-add-box"
                             action="#{topicController.doCreateNewTopic()}" value="Create new Topic">
                <f:setPropertyActionListener value="#{topic}" target="#{topicController.topic}"/>
            </p:commandButton>
            <!---  test functions
            <p:commandButton style="width: 25%; margin-top: 25px; float: right;"
                          action="#{}" value="Import terms">
                </p:commandButton>
            -->
            <!---
            <p:fileUpload value="#{PrimefacesFileUpload.uploadedFile}" mode="simple" sizeLimit="50000"
                                allowTypes="/(\\\\\\\\./\\\\\\\\/)(gif|jpe?g|png|txt|json)$/"/>
                  <p:growl id="messages" showDetail="true"/>
                  <p:commandButton value="Submit" actionListener="#{PrimefacesFileUpload.upload}" ajax="false"/> -->
        </h:form>

        <h:form id="createTopicForm">
            <p:growl id="growl" showDetail="false" life="6000">
                <p:autoUpdate/>
            </p:growl>
            <p:dialog header="Create new Topic" id="topicCreationDialog" widgetVar="topicCreationDialog" modal="true"
                      showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="topicCreateData">
                    <h:panelGrid columns="2">
                        <p:outputLabel for="topicName" value="Topic Name: "/>
                        <p:inputText id="topicName" value="#{topicController.topic.topicName}"/>
                    </h:panelGrid>
                    <h:panelGrid columns="2">
                        <p:commandButton value="Save" action="#{topicController.doSaveTopic()}"
                                         oncomplete="PF('topicCreationDialog').hide()"
                                         update=":topicForm:topicCreationTable :createTopicForm"/>
                        <p:commandButton value="Abort" onclick="PF('Dialog').hide()"/>
                    </h:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>

        <h:form id="termsForm" style="display: none" enctype="multipart/form-data">
            <p:growl id="termsCreate" showDetail="false" life="6000">
                <p:autoUpdate/>
            </p:growl>
            <p:dataTable widgetVar="termsTable" id="termsTable" var="term" value="#{termListController.termsByTopic}"
                         style="width: 83%; margin-top: 110px; float: right;">
                <f:facet name="header">Creat new Term for Selected Topic</f:facet>
                <p:column headerText="Term name">
                    <h:outputText value="#{term.termName}"/>
                </p:column>

                <!--                <p:column style="width:100px;text-align: center" headerText="edit term">-->

                <!--                <p:commandButton title="Edit" icon="ui-icon-note" update=":termsForm:termsTable" oncomplete="PF('termEditDialog').show()">-->
                <!--                    <f:setPropertyActionListener value="#{term}" target="#{termsController.term}" />-->
                <!--                </p:commandButton>-->
                <!--                </p:column>-->

            </p:dataTable>
            <p:commandButton style="width: 25%; margin-top: 25px; float: right;"
                             oncomplete="PF('termCreationDialog').show()" icon="ui-icon-add-box"
                             action="#{termsController.doCreateNewTerm()}" value="Create new Term">
                <f:setPropertyActionListener value="#{term}" target="#{termsController.term}"/>
            </p:commandButton>

            <p:dialog header="Create new Term" id="termCreationDialog" widgetVar="termCreationDialog" modal="true"
                      showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="termCreateData">
                    <h:panelGrid columns="2">
                        <p:outputLabel for="termName" value="Term Name: "/>
                        <p:inputText id="termName" value="#{termsController.term.termName}"/>
                    </h:panelGrid>

                    <p:separator/>

                    <h:panelGrid columns="2">
                        <p:commandButton value="Save"
                                         action="#{termsController.doSaveTerm(topicController.gameTopicCount.topic)}"
                                         oncomplete="PF('termCreationDialog').hide()" update=":termsForm:termsTable"/>
                        <p:commandButton value="Abort" onclick="PF('Dialog').hide()"/>
                    </h:panelGrid>

                </p:outputPanel>
            </p:dialog>
        </h:form>

        <!--        <h:form>-->
        <!--            <p:dialog header="Edit Term" id="termEditDialog" widgetVar="termEditDialog" modal="true" showEffect="fade"-->
        <!--                      hideEffect="fade" resizable="false">-->
        <!--                <p:outputPanel id="termData" rendered="#{not empty termsController.term}">-->
        <!--                    <h:panelGrid columns="2">-->
        <!--                        <p:outputLabel for="newTermName" value="Term Name: "/>-->
        <!--                        <p:inputText id="newTermName" value="#{termsController.term.termName}"/>-->
        <!--                    </h:panelGrid>-->

        <!--                    <p:separator/>-->

        <!--                    <h:panelGrid columns="2">-->
        <!--                        <p:commandButton value="Save" action="#{termsController.editTerm(term ,topicController.topic)}"-->
        <!--                                         oncomplete="PF('termEditDialog').hide()" update=":termsForm:termsTable"/>-->
        <!--                        <p:commandButton value="Abort" onclick="PF('Dialog').hide()"/>-->
        <!--                    </h:panelGrid>-->
        <!--                </p:outputPanel>-->
        <!--            </p:dialog>-->
        <!--        </h:form>-->


    </ui:define>
</ui:composition>